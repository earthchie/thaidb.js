/*
 * ThaiDB v. 1.0 (21 June 2014)
 * Created By Earthchie (http://www.earthchie.com/)
 * @require JQuery 1.8 or newer
 * Database source: http://www.ssckp.org/information-technology-for-crewphra-news/79-temples-tumbons-districts-amphures-77-provinces-database
 */
var scripts=document.getElementsByTagName("script");var base_path=scripts[scripts.length-1].src.split("?")[0].split("/").slice(0,-1).join("/")+"/";var ThaiDB=function(e){e=$.extend({district:'[name="district"]',amphoe:'[name="amphoe"]',province:'[name="province"]',zipcode:'[name="zipcode"]'},e);var t=function(e){if(localStorage){return JSON.parse(localStorage.getItem("thaidb-"+e))}else{return""}};var n=function(e,t){if(localStorage){return localStorage.setItem("thaidb-"+e,JSON.stringify(t))}else{return""}};var r=function(e,r){if($.isEmptyObject(t(e))){$.ajax({type:"GET",url:base_path+e+".json",async:true,dataType:"json"}).always(function(i){n(e,i);r(t(e))})}else{r(t(e))}};var i=function(t){if(t){r("zipcodes",function(n){var n=new JQL(n);var r=n.select("*").where("dc").equalTo(t.dc).fetch().pop();if(r){e.zipcode.val(r.zip)}})}};var s=function(t){if(t){r("provinces",function(n){var n=new JQL(n);var r=n.select("*").where("pid").equalTo(t.pid).fetch().pop();if(r){e.province.val(r.p)}})}};var o=function(t){if(t){r("amphoes",function(n){var n=new JQL(n);var r=n.select("*").where("aid").equalTo(t.aid).fetch().pop();if(r){e.amphoe.val(r.a);s(r)}});i(t)}};for(var u in e){if(u!="db_path"){e[u]=$(e[u])}}e.district.change(function(){var e=$(this);r("districts",function(t){var t=new JQL(t);var n=t.select("*").where("d").equalTo(e.val()).fetch().pop();o(n)})});e.amphoe.change(function(){var e=$(this);r("amphoes",function(t){var t=new JQL(t);var n=t.select("*").where("a").equalTo(e.val()).fetch().pop();s(n)})});this.preload=function(){r("amphoes",function(){});r("districts",function(){});r("provinces",function(){});r("zipcodes",function(){})};return this}

/*
 * FQL v. 1.0 (20 May 2014)
 * Created By Earthchie (http://www.earthchie.com/)
 */
var JQL=function(e){this.data_source=e;this.buffer=e;this.focused_field="";this.fields=[];this.size=false;for(var t in e){for(var n in e[t]){this.fields.push(n)}break}this.fetch=function(){if(typeof this.fields=="object"){var e={};for(var t in this.buffer){e[t]={};for(var n in this.fields){var r=this.fields[n];if(this.buffer[t][r]){e[t][r]=this.buffer[t][r]}}}this.buffer=e}if(this.size){var i=this.size.toString().split(",");var s=0;var o=this.size;if(i.length>1&&i[0]<i[1]){s=parseInt(i[0]);o=s+parseInt(i[1])}var u={};for(var t=s;t<o;t++){if(this.buffer[t]){u[t]=this.buffer[t]}else{break}}this.buffer=u}return this.buffer};this.new=function(e){this.data_source=e;this.buffer=e};this.limit=function(e){this.size=e;return this};this.select=function(e){this.fields=e;this.buffer=this.data_source;this.size=false;return this};this.where=function(e){this.focused_field=e;return this};this.and=function(e){return this.where(e)};this.contains=function(e,t){if(t==undefined){t==false}var n=this.buffer;this.buffer=[];for(var r in n){if(t){if(~n[r][this.focused_field].indexOf(e)){this.buffer.push(n[r])}}else{if(~n[r][this.focused_field].toLowerCase().indexOf(e.toLowerCase())){this.buffer.push(n[r])}}}return this};this.equalTo=function(e){var t=this.buffer;this.buffer=[];for(var n in t){if(t[n][this.focused_field]==e){this.buffer.push(t[n])}}return this};this.in=function(e){var t=this.buffer;this.buffer=[];for(var n in t){if(this.in_array(t[n][this.focused_field],e)){this.buffer.push(t[n])}}return this};this.moreThan=function(e){var t=this.buffer;this.buffer=[];for(var n in t){if(parseFloat(t[n][this.focused_field])>parseFloat(e)){this.buffer.push(t[n])}}return this};this.moreThanOrEqualTo=function(e){var t=this.buffer;this.buffer=[];for(var n in t){if(parseFloat(t[n][this.focused_field])>=parseFloat(e)){this.buffer.push(t[n])}}return this};this.lessThan=function(e){var t=this.buffer;this.buffer=[];for(var n in t){if(parseFloat(t[n][this.focused_field])<parseFloat(e)){this.buffer.push(t[n])}}return this};this.lessThanOrEqualTo=function(e){var t=this.buffer;this.buffer=[];for(var n in t){if(parseFloat(t[n][this.focused_field])<=parseFloat(e)){this.buffer.push(t[n])}}return this};this.orderBy=function(e){var t="asc";var n=e.split(" ");if(n[1]&&n[1].toLowerCase()=="desc"){t="desc";e=n[0]}var r=[];for(var i in this.buffer){r.push([i,this.buffer[i][e]])}r.sort(function(e,t){return e[1]-t[1]});results=[];for(var i in r){results.push(this.buffer[r[i][0]])}this.buffer=results;if(t=="desc"){this.buffer=this.buffer.reverse()}return this};this.in_array=function(e,t){for(var n in t){if(e==t[n]){return true}}return false}}